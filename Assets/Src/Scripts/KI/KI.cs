using System;
using System.Collections;
using System.Collections.Generic;
using System.Text;
using UnityEngine;
using UnityEngine.UI;
using UnityEngine.Networking;

public class KI : MonoBehaviour
{

    public float timespan = 5f;  // seconds
    private float time;

    private string URL = "http://localhost:5173/api/search";

    public Camera camera;
    public PanelManager panel;
    public Text poi;


    public class ImageCategory
    {
        public string category;
        public double score;
    }
    
 
    public class Body
    {
        public List<double> vector;
    }


     private Texture2D CaptureRealTimeImage()
    {
        // The Render Texture in RenderTexture.active is the one
        // that will be read by ReadPixels.
        // var currentRT = RenderTexture.active;
        // RenderTexture.active = camera.targetTexture;

        // // Render the camera's view.
        // camera.Render();

        // // Make a new texture and read the active Render Texture into it.
        // Texture2D image = new Texture2D(camera.targetTexture.width, camera.targetTexture.height);
        // image.ReadPixels(new Rect(0, 0, camera.targetTexture.width, camera.targetTexture.height), 0, 0);
        // image.Apply();

        // // Replace the original active Render Texture.
        // RenderTexture.active = currentRT;

        // return image;

    return null;
    }

    private List<double> ExtractVector(Texture2D image)
    {
        // byte[] bytes = image.EncodeToPNG();
        // string fileName = "FILE_"

        // Sharp Transformers


        // tempor√§r
        double[] features = {-0.12468448281288147,-0.8732734322547913,-0.972376823425293,-1.435807466506958,0.29437559843063354,0.1274375468492508,-1.20254385471344,-1.251844882965088,-1.5994484424591064,-1.5277496576309204,-0.8119503259658813,-2.247504472732544,-1.6191843748092651,-1.548761248588562,-1.8270922899246216,-2.1419801712036133,-1.8248817920684814,-1.7039235830307007,-1.8181302547454834,-1.7572072744369507,-2.0838797092437744,-0.17522358894348145,-1.5740245580673218,-1.16497802734375,-1.669463038444519,-0.859260618686676,-0.27801015973091125,-1.0184725522994995,-0.4525619149208069,-0.4048174321651459,-1.583817958831787,-1.267398715019226,-1.326158881187439,-1.4364802837371826,0.08411471545696259,-1.7764488458633423,-0.3725087642669678,-1.9972048997879028,0.8455556035041809,-1.227428913116455,-1.5812865495681763,-0.6279609203338623,-0.4996829628944397,-0.7156949639320374,-1.0496057271957397,-0.5873836874961853,-1.0265846252441406,-0.3150560259819031,-1.41187584400177,-1.7891833782196045,-1.4120497703552246,0.2913764417171478,-0.5651028156280518,-0.3424036502838135,-1.182352066040039,-1.3687797784805298,-0.9653782844543457,-1.4008536338806152,-1.4722243547439575,-0.43527430295944214,0.1387874037027359,-0.6819603443145752,-0.5684797763824463,0.1070057600736618,-0.3160300552845001,-0.7369892597198486,-0.2480628341436386,-0.49567341804504395,-0.29646065831184387,0.3819010853767395,-1.2036733627319336,0.42833563685417175,-1.5622514486312866,1.119881272315979,-1.5012054443359375,-0.45316874980926514,-0.6342626214027405,-0.4265616238117218,0.8800438642501831,0.22217699885368347,-1.912885069847107,-1.611508846282959,-2.538020610809326,-2.0351994037628174,-1.8028863668441772,-1.7224748134613037,-2.2865476608276367,0.23499158024787903,-1.512029767036438,-1.6061668395996094,-2.073179006576538,-1.2792292833328247,-1.3203096389770508,-1.694730520248413,-0.8901849389076233,-0.7241631746292114,-1.2010349035263062,-2.123755693435669,-1.6505571603775024,-2.227344274520874,-2.3124117851257324,-1.2677028179168701,-1.002027988433838,0.04327518120408058,-0.991579532623291,-1.7828524112701416,-1.4324907064437866,-0.6220643520355225,-1.6314735412597656,-1.2662420272827148,-1.6243419647216797,1.19207763671875,-0.47056567668914795,-1.5515347719192505,-1.3531447649002075,-1.7878056764602661,-1.583667516708374,0.7908483743667603,-0.8464152216911316,-1.1860730648040771,-1.034794569015503,-0.8876476883888245,-0.13586246967315674,-1.3450781106948853,-1.3239129781723022,-1.5051658153533936,-0.37579864263534546,-1.7132056951522827,-0.7262251377105713,-2.0582871437072754,-2.1144649982452393,-1.417059063911438,-0.8363701105117798,-1.9805867671966553,-2.1436874866485596,-1.2820334434509277,-2.056454658508301,-1.5953229665756226,-2.51847767829895,-1.9054102897644043,-1.7996169328689575,-1.164663553237915,-1.4084590673446655,-1.8230938911437988,-1.857027530670166,-1.4632066488265991,-1.713200569152832,-1.1934051513671875,-1.7327661514282227,-0.995010495185852,-1.6884902715682983,-0.15011794865131378,-0.48015034198760986,-0.4340154230594635,-0.6139072775840759,-0.5917418599128723,-0.7951333522796631,-0.3343982994556427,-0.38854971528053284,-0.4870735704898834,0.19972020387649536,-0.09313362091779709,-0.37118905782699585,-0.06763680279254913,0.3339175581932068,-0.7210192680358887,-0.4779509902000427,-0.6287369132041931,0.002286524511873722,-0.032107483595609665,-0.47002148628234863,0.18363894522190094,-0.49240726232528687,-0.14533331990242004,-0.5739213228225708,-0.8860983848571777,-0.44228440523147583,-0.0658324807882309,-0.13817857205867767,-0.7665170431137085,-1.4905401468276978,-0.24889583885669708,-1.2279282808303833,-0.01726510189473629,-0.602421224117279,-0.6705265045166016,-0.6349474787712097,-0.03192935138940811,-0.7319096326828003,-1.364139199256897,-0.25522297620773315,-0.7942957282066345,-1.0818918943405151,-0.9099496006965637,-0.6253742575645447,-0.09948286414146423,-0.8681787252426147,-0.9131617546081543,-0.8237796425819397,-0.4541398882865906,-1.3611016273498535,-1.2265546321868896,-0.8376572728157043,-0.5938767194747925,-0.5683998465538025,-0.9039307832717896,-0.14755722880363464,-0.6126055717468262,-0.1888502836227417,-0.5311452150344849,-0.3129633963108063,0.04938400536775589,-0.9759964346885681,-0.7474056482315063,-0.8956556916236877,-0.34653761982917786,-0.23126472532749176,-0.49788960814476013,-1.184267282485962,-0.9329002499580383,0.15777043998241425,-0.052845217287540436,-0.26973000168800354,-0.2524709105491638,0.052279699593782425,-0.1514085978269577,-1.1485172510147095,-1.1073919534683228,-0.19988621771335602,-0.7638195753097534,-0.8693605065345764,-1.0069297552108765,-0.9270873069763184,-0.7286669611930847,-1.1336321830749512,-0.1611393839120865,-0.47706255316734314,-0.6300259232521057,-1.2251180410385132,-0.6844964027404785,-1.1619696617126465,-2.0299811363220215,-0.7302836179733276,-0.7142807245254517,-1.11634361743927,-0.20322607457637787,0.017448341473937035,-0.6791484951972961,-0.945598304271698,-0.7382632493972778,-0.9609812498092651,-0.27584895491600037,-0.41627946496009827,-0.7374194860458374,-0.16482014954090118,-0.833706796169281,-0.40776389837265015,-0.42046236991882324,-0.0045128497295081615,-0.8333421349525452,-0.9915798902511597,-0.4564623534679413,-0.5788401961326599,-0.2674715220928192,-0.27731257677078247,-0.10990744829177856,-0.5887690782546997,-0.5442986488342285,-0.756664514541626,-1.794054388999939,-1.2585484981536865,-1.8200831413269043,-1.3660848140716553,-0.8417859673500061,-1.3460215330123901,-1.3281718492507935,-1.3752870559692383,-1.1591598987579346,-1.5156172513961792,-1.089608907699585,-1.032792329788208,-0.38554006814956665,-0.9818727374076843,-0.005961621180176735,-0.30601274967193604,0.9505738019943237,-1.486151099205017,-1.5169463157653809,-1.1565062999725342,-2.3203659057617188,-1.7636131048202515,-1.5627425909042358,-1.7038769721984863,-1.598744511604309,-2.558621406555176,-2.3227689266204834,-1.7362511157989502,-1.822088599205017,-1.2235724925994873,-1.3354213237762451,-1.1432782411575317,-1.4942280054092407,-0.9825782775878906,-0.17809918522834778,-1.4790012836456299,-0.978238046169281,0.25429195165634155,-1.1607871055603027,-0.3757759630680084,-1.1016765832901,0.15819625556468964,-1.3871400356292725,-1.2927067279815674,-1.0030983686447144,0.5368695259094238,-1.4954450130462646,-1.3420299291610718,-1.9461230039596558,-0.5354605913162231,-0.5128731727600098,-1.458186388015747,-2.1782400608062744,-1.6228457689285278,-1.1464120149612427,-1.6353938579559326,-1.3936799764633179,-0.7152377367019653,-1.1227270364761353,-1.1156959533691406,-1.4211127758026123,-1.0536978244781494,-1.261346459388733,-1.0237956047058105,-0.07481731474399567,-1.451980471611023,-0.7218455672264099,-1.8927271366119385,-1.0386688709259033,-1.2368454933166504,-1.2178618907928467,-1.4306720495224,-0.8294111490249634,-1.8648439645767212,-1.5510804653167725,-1.9622576236724854,-1.6803674697875977,-1.4936821460723877,-1.6693458557128906,-2.589718818664551,-1.783435344696045,-0.9712189435958862,-0.9633370637893677,-1.147547721862793,-1.0340334177017212,-0.47521692514419556,-0.8243521451950073,0.9027764201164246,-0.3173646926879883,-0.25803497433662415,-0.002226538024842739,-1.4071452617645264,-0.5509617328643799,-1.283597707748413,-0.43881192803382874,-1.3330488204956055,-1.5142223834991455,-1.7841017246246338,-1.5268727540969849,-1.6957175731658936,-1.6035559177398682,-1.8918932676315308,-1.9989560842514038,-2.151463031768799,-1.9106581211090088,-0.826096773147583,-2.1543760299682617,-1.7222415208816528,-1.1620475053787231,-1.7779539823532104,-1.465559482574463,-0.7408437728881836,-1.715562105178833,-1.5179179906845093,-1.8746944665908813,-1.4085056781768799,-1.3017336130142212,-1.9544363021850586,-1.851206660270691,-2.299208879470825,-0.35414567589759827,-1.6976697444915771,-0.5738394856452942,-0.48674681782722473,-1.9876484870910645,-0.40926387906074524,-0.0855197161436081,-1.4406754970550537,-1.7170213460922241,0.8792545199394226,1.607537865638733,-0.16635659337043762,1.1217081546783447,1.6474323272705078,-1.4664852619171143,-0.07554952800273895,1.23073410987854,-0.9755957722663879,-0.007354369852691889,-1.20286226272583,2.7104415893554688,-0.539506733417511,0.5152750611305237,1.5490119457244873,4.758375644683838,0.923849880695343,-0.986885130405426,1.464926838874817,0.44902515411376953,2.0016186237335205,1.586117148399353,1.4250150918960571,1.9038249254226685,2.2395455837249756,0.6383152008056641,-0.9727873802185059,-1.0155534744262695,1.3153693675994873,0.5606977939605713,0.06600284576416016,0.26517271995544434,0.2740333378314972,1.1181279420852661,3.367398977279663,0.4067675769329071,0.3359863758087158,1.744219183921814,0.014262503013014793,-0.977059006690979,2.5869815349578857,0.8496630787849426,0.5051960945129395,0.4229402542114258,-0.1299927830696106,-0.29502928256988525,0.031146042048931122,0.1569971740245819,2.5348753929138184,1.7844558954238892,-0.3190370798110962,-1.258987307548523,-0.7228445410728455,1.717099666595459,0.6773993968963623,-0.66717529296875,-1.0879478454589844,-0.07764178514480591,3.5926613807678223,1.4820945262908936,-0.12810680270195007,0.6500136852264404,-1.161267876625061,1.4312376976013184,3.9063799381256104,2.4201483726501465,2.4230120182037354,2.2009763717651367,0.3092237710952759,-1.256389856338501,-0.3818686902523041,1.5468535423278809,2.0659472942352295,1.0763092041015625,-0.7293834090232849,4.859731197357178,-0.11517565697431564,0.028212957084178925,-0.22826245427131653,1.8784674406051636,2.2377517223358154,-0.44844451546669006,1.0882114171981812,1.4250504970550537,0.8685597777366638,-1.3882955312728882,-1.0250284671783447,1.4377351999282837,1.028401255607605,2.0325074195861816,2.971139669418335,-0.4741029441356659,0.9639736413955688,2.6033267974853516,0.18014760315418243,-0.10091125965118408,0.7091979384422302,-0.5491920113563538,0.2136780321598053,-0.8834852576255798,-0.9288968443870544,4.471216678619385,-1.0509182214736938,1.4634772539138794,1.904782772064209,2.116307258605957,1.343153953552246,1.8784081935882568,1.164326786994934,2.094836473464966,0.6732094287872314,-1.5013341903686523,-1.0453288555145264,-0.661200225353241,3.551145553588867,1.967913269996643,0.3372667133808136,1.0011192560195923,1.3398823738098145,1.2598377466201782,0.9581543207168579,1.250876545906067,0.38495656847953796,-0.02552216313779354,0.6601136326789856,2.325653553009033,1.339001178741455,-0.7667099833488464,1.6962591409683228,1.6829677820205688,0.7680831551551819,0.5081684589385986,2.069631576538086,1.5937327146530151,0.6577695608139038,-0.7859862446784973,1.770769715309143,1.099982500076294,-1.274343729019165,-1.3931323289871216,-0.3578084111213684,0.7396708726882935,-1.2019068002700806,0.986090898513794,1.7389309406280518,2.5283918380737305,0.5838664770126343,2.6620523929595947,2.9696662425994873,-1.1907150745391846,0.290459543466568,3.40893816947937,1.7571613788604736,0.9902719855308533,-0.3594229221343994,1.1057566404342651,-1.1186856031417847,-0.10005109012126923,2.041327714920044,1.023535966873169,3.175976276397705,2.0888068675994873,0.658319354057312,-0.024788748472929,-0.7730398178100586,1.0169122219085693,-0.6864169836044312,0.5792353749275208,1.6017565727233887,1.846116542816162,-0.4643794596195221,-0.510174572467804,2.386505365371704,0.2921347916126251,1.733306884765625,0.19712328910827637,0.94927579164505,-0.6187129020690918,-1.3129065036773682,0.7804509997367859,0.8108152747154236,0.2398722767829895,-0.5248304009437561,0.009541969746351242,-0.8320478796958923,1.4685529470443726,3.1703567504882812,0.9058914184570312,0.2383033037185669,3.90216064453125,1.0700962543487549,3.176285743713379,1.8108561038970947,0.6832494735717773,1.1872936487197876,2.7867438793182373,1.0996720790863037,0.03450867533683777,4.474361896514893,2.7854502201080322,0.23248633742332458,0.08278392255306244,5.121992111206055,0.7390149235725403,2.236968517303467,-0.9444093108177185,1.947939395904541,1.2189621925354004,2.0990772247314453,-0.13553208112716675,0.9250062108039856,-0.9808629155158997,2.3015248775482178,-0.9585988521575928,-0.5122568011283875,2.330244302749634,0.033489882946014404,2.2669143676757812,2.131110668182373,0.4408215880393982,3.2154369354248047,2.6609742641448975,1.5234475135803223,1.1309279203414917,0.04080931842327118,2.652121067047119,-0.22319555282592773,-0.3988689184188843,2.6395034790039062,-0.12062966823577881,-1.2526967525482178,1.9071706533432007,0.48278090357780457,0.8081853985786438,2.6432759761810303,2.1197261810302734,0.24649465084075928,3.058212995529175,1.3379850387573242,0.6365991234779358,1.3860987424850464,-0.5534212589263916,-0.29643893241882324,2.264575719833374,0.608278214931488,1.5606449842453003,2.094679832458496,-1.263389229774475,0.09338972717523575,1.9994455575942993,0.32251232862472534,-0.3670380413532257,3.4382669925689697,1.4373871088027954,0.5918601751327515,1.6170190572738647,-0.07359959185123444,-0.29178065061569214,-0.6466545462608337,0.8532733917236328,0.3946264088153839,0.0012003714218735695,-0.5081402063369751,-1.4619134664535522,2.668071746826172,-1.200852394104004,2.3334295749664307,-0.1198895201086998,2.5780272483825684,1.062846064567566,-0.5675099492073059,0.8684684634208679,0.6917725801467896,-0.45902571082115173,0.49099844694137573,2.053898334503174,3.744854211807251,0.8756304383277893,2.743259906768799,2.8732759952545166,0.5082055926322937,0.28879761695861816,2.070082426071167,1.723400592803955,0.03704125061631203,3.5459401607513428,2.2252092361450195,0.005034308880567551,3.6265900135040283,-0.393061101436615,1.875950574874878,0.15093526244163513,-0.6793791651725769,1.6766674518585205,0.8958570957183838,1.4152286052703857,-1.037788987159729,1.0637810230255127,0.34838372468948364,0.5348924994468689,-0.8151271939277649,3.1032676696777344,2.7226836681365967,0.4364696741104126,2.1037418842315674,-0.282040536403656,0.11405842751264572,0.4425799548625946,-1.24072265625,0.4610312581062317,2.0927574634552,-0.20177659392356873,2.3165128231048584,0.9345901012420654,0.8723246455192566,2.3007493019104004,2.669440269470215,1.8455528020858765,-0.5968745350837708,-0.7090736031532288,-0.3971391022205353,1.1834484338760376,1.884399175643921,-1.074127435684204,0.668247640132904,0.21904419362545013,-1.5102849006652832,1.5509223937988281,2.8976893424987793,0.11286662518978119,1.913690209388733,1.7763680219650269,0.26570144295692444,3.191251516342163,0.7355560660362244,2.7108945846557617,-1.0261353254318237,0.04544806852936745,0.5498778223991394,0.5597822070121765,-0.10032619535923004,0.5533965229988098,3.499558925628662,0.5629314184188843,1.9852386713027954,0.6338804364204407,1.659910798072815,1.6594164371490479,1.6431176662445068,2.0136280059814453,1.1931711435317993,2.8422298431396484,-0.15426866710186005,0.29580748081207275,0.7887166142463684,2.3231637477874756,2.3453314304351807,0.14572185277938843,-0.11681033670902252,0.3548111319541931,3.207751512527466,0.4478873908519745,0.5706799030303955,2.583498001098633,-0.7219570875167847,4.6897687911987305,4.3489556312561035,1.0039901733398438,1.0089354515075684,1.6114908456802368,-0.07709184288978577,3.1918115615844727,1.4599021673202515,2.0725598335266113,3.116455078125,0.2290274202823639,1.641087293624878,0.10179085284471512,2.2927377223968506,4.00410795211792,1.9409029483795166,-0.36526182293891907,-1.2364084720611572,0.6157240867614746,2.536498546600342,3.1045339107513428,2.7368948459625244,0.3124983608722687,0.43501079082489014,1.0239940881729126,-0.6382576823234558,0.29131245613098145,1.2748221158981323,0.8138349056243896,4.10996675491333,0.848781943321228,1.2636085748672485,0.6095256209373474,1.693303108215332,0.7104492783546448,1.8759021759033203,-0.21368151903152466,-0.08989983797073364,-0.1789356917142868,-1.2470524311065674,-0.7971192598342896,2.34264874458313,1.0663104057312012,0.259409636259079,1.42454993724823,0.29932862520217896,-0.6202094554901123,0.7320703268051147,3.169220447540283,0.6052505373954773,2.8769326210021973,-0.6459465026855469,-1.1824859380722046,-0.6157369613647461,-0.04586590826511383,4.205932140350342,0.24960041046142578,-1.2014755010604858,-1.4873228073120117,0.14805224537849426,1.0395959615707397,0.3102084696292877,-1.064271330833435,1.937085509300232,2.286557912826538,2.4834370613098145,-1.5559402704238892,1.4428834915161133,1.185673475265503,-1.5549302101135254,-1.4912002086639404,0.2199382781982422,0.10592455416917801,1.9607107639312744,1.8103221654891968,1.6556825637817383,-0.20538140833377838,2.3007736206054688,0.7209984064102173,1.0416136980056763,1.2192403078079224,2.670727491378784,1.9639147520065308,2.5900535583496094,-0.3392983078956604,0.9239169955253601,-0.3191109895706177,-1.0228439569473267,2.47444224357605,0.7866688370704651,-0.744766354560852,1.170933723449707,1.4397445917129517,0.09881525486707687,-0.35813820362091064,0.11576329916715622,2.052543878555298,0.1645149290561676,1.8283830881118774,2.039642810821533,-0.6958269476890564,-1.3754291534423828,-1.3641859292984009,-0.58867347240448,-0.26501309871673584,1.918001651763916,0.3280387222766876,0.6490350365638733,-1.0556113719940186,2.9751298427581787,-1.489303469657898,-0.7556949257850647,2.089519739151001,0.6099090576171875,1.0461171865463257,0.7342597842216492,1.6396207809448242,0.2263338714838028,1.0941704511642456,2.573298692703247,2.3364639282226562,-0.36174219846725464,0.9566401839256287,-0.5822020769119263,-0.5966718792915344,-1.6186977624893188,1.7955403327941895,-0.4147009253501892,1.3210605382919312,1.84498929977417,1.3606950044631958,0.3686397969722748,-0.400798499584198,2.3246822357177734,0.8485500812530518,1.6290637254714966,2.170897960662842,-0.5186070799827576,1.1419811248779297,4.2484211921691895,-0.38871094584465027,1.1014727354049683,0.9069036841392517,1.1722707748413086,1.078223705291748,0.037152357399463654,0.4873228669166565,1.1329344511032104,0.060719504952430725,-1.210579752922058,-0.9626917243003845,-1.0548559427261353,-0.9552187919616699,2.0122132301330566,-0.3690316379070282,-0.6084621548652649,0.6470277309417725,1.3684285879135132,0.6053615808486938,-0.3699178099632263,0.016729634255170822,-1.516823410987854,-0.6044430136680603,-0.22234933078289032,-0.7780506610870361,-1.006062626838684,0.6362826228141785,-0.4118098020553589,-1.7923939228057861,-0.879758894443512,-2.022447109222412,-0.6285790205001831,-1.7082425355911255,-0.5125654935836792,-0.6983006596565247,-1.3714052438735962,-1.1153689622879028,-2.041494131088257,-1.91569185256958,-1.2812126874923706,-0.8230493664741516,-1.11649489402771,-0.8636196255683899,-1.0913594961166382,-1.6070448160171509,0.26945629715919495,0.061741191893815994,-1.0570757389068604,-1.1195992231369019,-0.4989844560623169,-0.55717933177948,-0.6917896866798401,-1.465022087097168,-1.0581839084625244,-1.0682111978530884,-0.8352892398834229,-1.7992470264434814,-0.4858931303024292,-0.9815765619277954,-1.932973861694336,-1.3527641296386719,-1.1852107048034668,-0.8566629886627197,0.9806396961212158,-0.11043963581323624,1.119989275932312,0.08008193969726562,-1.7721601724624634,-0.2841785252094269,-0.7094157934188843,-2.1836202144622803,-1.1706271171569824,-0.767931342124939,-1.9155268669128418,-0.7677322030067444,-1.1950204372406006,-1.5382245779037476,-1.4930753707885742,-0.1303883194923401,-0.4468163847923279,-1.1996830701828003,-1.5032813549041748,-1.2982778549194336,-1.3118563890457153,-0.5140832662582397,-1.4031634330749512,-1.0581004619598389,-0.7735083699226379,-1.7852355241775513,-1.113991141319275,-1.3439557552337646,-1.4520633220672607,-0.28681680560112,-0.6915827393531799,-1.4813942909240723,0.002626422792673111,1.9621846675872803};
        List<double> vector = new List<double>(features);
        return vector;
    }


    private IEnumerator Process(List<double> vector) {
        Body body = new Body();
        body.vector = vector;

        string bodyContent = JsonUtility.ToJson(body); 

        Debug.Log("body: " + bodyContent);

        UnityWebRequest request = new UnityWebRequest(URL, "POST");
        byte[] bodyRaw = Encoding.UTF8.GetBytes(bodyContent);
        request.uploadHandler = (UploadHandler) new UploadHandlerRaw(bodyRaw);
        request.downloadHandler = (DownloadHandler) new DownloadHandlerBuffer();
        request.SetRequestHeader("Content-Type", "application/json");

        yield return request.SendWebRequest();

        Debug.Log("fetched from api");

        if (request.result == UnityWebRequest.Result.Success)
        {
            Debug.Log("success");
            string wrappedResponse = "{\"items\":" + request.downloadHandler.text + "}";
            ImageCategory category = JsonUtility.FromJson<ImageCategory>(request.downloadHandler.text );

            poi.text = category.category;
            panel.Open();
        }
        else 
        {
            Debug.Log("not found");
            panel.Close();
        }
        
    }

   

    void Start()
    {
        time = Time.time + timespan;
    }
    
    void Update()
    {
        if (time <= Time.time)
        {
            Texture2D image = CaptureRealTimeImage();
            Debug.Log("image captured");
            
            List<double> vector = ExtractVector(image);
            Debug.Log("extracted vector " + vector);

            StartCoroutine(Process(vector));
    
            time = Time.time + timespan;
        }
    }
}
